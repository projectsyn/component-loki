parameters:
  loki:
    =_metadata:
      multi_instance: true

    name: ${_instance}
    namespace:
      name: syn-loki
      create: true
      metadata: {}

    # secrets:
    #   loki-bucket-secret:
    #     stringData:
    #       S3_ACCESS_KEY_ID: null
    #       S3_SECRET_ACCESS_KEY: null
    #       S3_ENDPOINT: null

    globalNodeSelector: {}

    charts:
      loki: "6.12.0"

    alerts:
      additionalRules: {}
      patchRules:
        ignoreNames: []
        patches: {}

    helm_values:
      loki:
        schemaConfig:
          configs:
            - from: 2024-04-01
              store: tsdb
              object_store: s3
              schema: v13
              index:
                prefix: loki_index_
                period: 24h
        ingester:
          chunk_encoding: snappy
        tracing:
          enabled: true
        querier:
          max_concurrent: 4

        storage:
          type: s3
          bucketNames:
            chunks: "chunks"
            ruler: "ruler"
            admin: "loki-admin"
          s3:
            # s3 URL can be used to specify the endpoint, access key, secret key, and bucket name
            #s3: s3://access_key:secret_access_key@custom_endpoint/bucket_name
            # AWS endpoint URL
            endpoint: objects.lpg.cloudscale.ch
            # AWS region where the S3 bucket is located
            region: lpg
            # AWS secret access key
            secretAccessKey: veryvery
            # AWS access key ID
            accessKeyId: secret
            # AWS signature version (e.g., v2 or v4)
            #signatureVersion: <your-signature-version>
            # Forces the path style for S3 (true/false)
            s3ForcePathStyle: true
            # Allows insecure (HTTP) connections (true/false)
            insecure: false
            # HTTP configuration settings
            http_config: {}

        podSecurityContext:
          fsGroup: null
          runAsGroup: null
          runAsUser: null

        limits_config:
          retention_period: 30d

      deploymentMode: SimpleScalable

      backend:
        replicas: 3
      read:
        replicas: 3
      write:
        replicas: 3

      # Disable minio storage
      minio:
        enabled: false

      # Zero out replica counts of other deployment modes
      singleBinary:
        replicas: 0

      ingester:
        replicas: 0
      querier:
        replicas: 0
      queryFrontend:
        replicas: 0
      queryScheduler:
        replicas: 0
      distributor:
        replicas: 0
      compactor:
        replicas: 0
        retention_enabled: true
      indexGateway:
        replicas: 0
      bloomCompactor:
        replicas: 0
      bloomGateway:
        replicas: 0

      rbac.pspEnabled: false
      rbac.sccEnabled: true

      gateway:
        podSecurityContext:
          fsGroup: null
          runAsGroup: null
          runAsUser: null
        ingress:
          # -- Specifies whether an ingress for the gateway should be created
          enabled: true
          annotations:
            cert-manager.io/cluster-issuer: letsencrypt-production
          hosts:
            - host: loki.example.cm
              paths:
                - path: /
                  pathType: Prefix
          tls:
            - secretName: loki-gateway-tls
              hosts:
                - loki.example.com
        basicAuth:
          # -- Enables basic authentication for the gateway
          enabled: true
          # -- The basic auth username for the gateway
          username: username
          # -- The basic auth password for the gateway
          password: verysecretpassword

      global:
        dnsService: dns-default
        dnsNamespace: openshift-dns

        image:
            # -- Overrides the Docker registry globally for all images
            registry: dockerhub.vshn.net

      sidecar:
        image:
          # -- The Docker registry and image for the k8s sidecar
          repository: dockerhub.vshn.net/kiwigrid/k8s-sidecar

      memcached:
        image:
          # -- Memcached Docker image repository
          repository: dockerhub.vshn.net/library/memcached

      memcachedExporter:
        image:
          repository: dockerhub.vshn.net/prom/memcached-exporter

      test:
        enabled: false

      lokiCanary:
        enabled: false
